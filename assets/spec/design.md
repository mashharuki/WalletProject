# IDQ soulWallet の概要設計書

## 背景・目的

Web3 時代とは「デジタルで個人が Wallet と DID で個人がデータ管理ができること」だと考えています。
Web3 はまだ一般的には普及しておりません。これがその起爆剤になります。

デジタル ID と IDQ Token を利用した送金処理により、簡単に Wallet 機能を利用することができます。また、デジタル ID は DID として発行され、将来的に VC と連携させることで様々なデータを紐付けることが可能です。

## 解決したい課題

- 秘密鍵を管理しなければならない煩雑さ・難しさ
- 主流になっているウォレット「MetaMask」の UX の課題
- 仕組み上、PC とスマホの両方に対応させるのにも開発コストがかかる

## 特異性(IDQ Soul Wallet でないといけない部分)

- 秘密鍵がいらないのにデジタル ID/送金のセキュアで使い方がすごく簡単であること。
- QR コードをスマホでスキャンするだけで Wallet アクセスできること。
- API ファースト（ガス代が必要な処理などは、すべて API サーバー側で処理すること。bundler に近いイメージ)
- Web ブラウザで完結させること。
- DID による ID とデータの管理を可能にできること。

## 概要図

<img src="./../img/IDQ-システム構成図.drawio.png">

## 想定フロー (新規登録〜送金まで)

[![](https://mermaid.ink/img/pako:eNqdVVtPE0EU_iuTfYKAD_C4DyQm1YQHE40mvvRlabfa0G5xu01DCAk7A7RACZcgBCxCESqIFrFysVT6Yw67bf-FZ2ZK3aVFjX1odma-853v3GYmlFAirCuqktTfpHQjpAei2itTiwcNgj8rasV0Mhx45rKyU9oC9hbYF2BV0uOuf20Ul-qbV83cN7AXgM45M6dufu6lFovpljNz0MysgH0N9kewS-6ZDTTXKzm1lJUwUvER3WytQ1bCJMCKyAv0HP-9-4m0oZsDcmdMM61oKDqmGRZJDhAtSW4FlYFlgR6Kj7ku4EEOfvh0GOgZ98KW2168sAhHPRZ-x4GWW7TsCOgJfnTi0xzvDbsTYnHIi8SobpD7GGWE5MHQEImoGFEG2AYPiu53nFt_OUd7KQdoEegRsM_AGDq6-Zl3s8tuLlPfr0ijiMCnVZ_8ToXSUJp4KySssQQq8fbBzfV2c7eV16RUlBxUiTwU2V91Vqpgl51MBezNFnCwDQRWENU5BrqHdeTy6Q80crc2nKULJ7fusxDJWuIB0gtgB87UPtg56cu9zIJdE71HgS5gf9b3Ko1Pi-gUlz4WX1Sc8YSngNYwvcB2ga1wCXyzyhXR1eaUfVMr3JuRf2DA2XDm33mlRNoZiGixpI6YRm3tboIw3MBw4A-VbJ_K_XS7wtltN7_TmlSkLuTAnvVRY1vhiIu6V0Xdy_XNCuL8BRq4rWT9bNl9n28UDtsaurdG11bE2wDYlkBfgi0qjR7pFSaJdCfrk2yNchUz1yja7in1tlgfF6iSkdQ47zC75OmwDW8AfTzMeNSwenqd0g5GR_ynwkmbpRVjbc1Z_O731tEwv7PGvYuLrz5_7pbxyluVbfcfSTqWRD1i3Ld5rsRBb8dwOdM7KPEvw2Xd0YnCpqto1mUe0hy6KHp3FugHYOt3LHEAxNUuLZV-Ja6bcS0axidkgjMFFeu1HteDioqfYc0cDSpBYxJx_N5_Pm6EFNUyU3q_khoLa9btc-PffBSO4h2sqGIc-hVdLJ_Id0o8V5O_AD2bR5Y?type=png)](https://mermaid.live/edit#pako:eNqdVVtPE0EU_iuTfYKAD_C4DyQm1YQHE40mvvRlabfa0G5xu01DCAk7A7RACZcgBCxCESqIFrFysVT6Yw67bf-FZ2ZK3aVFjX1odma-853v3GYmlFAirCuqktTfpHQjpAei2itTiwcNgj8rasV0Mhx45rKyU9oC9hbYF2BV0uOuf20Ul-qbV83cN7AXgM45M6dufu6lFovpljNz0MysgH0N9kewS-6ZDTTXKzm1lJUwUvER3WytQ1bCJMCKyAv0HP-9-4m0oZsDcmdMM61oKDqmGRZJDhAtSW4FlYFlgR6Kj7ku4EEOfvh0GOgZ98KW2168sAhHPRZ-x4GWW7TsCOgJfnTi0xzvDbsTYnHIi8SobpD7GGWE5MHQEImoGFEG2AYPiu53nFt_OUd7KQdoEegRsM_AGDq6-Zl3s8tuLlPfr0ijiMCnVZ_8ToXSUJp4KySssQQq8fbBzfV2c7eV16RUlBxUiTwU2V91Vqpgl51MBezNFnCwDQRWENU5BrqHdeTy6Q80crc2nKULJ7fusxDJWuIB0gtgB87UPtg56cu9zIJdE71HgS5gf9b3Ko1Pi-gUlz4WX1Sc8YSngNYwvcB2ga1wCXyzyhXR1eaUfVMr3JuRf2DA2XDm33mlRNoZiGixpI6YRm3tboIw3MBw4A-VbJ_K_XS7wtltN7_TmlSkLuTAnvVRY1vhiIu6V0Xdy_XNCuL8BRq4rWT9bNl9n28UDtsaurdG11bE2wDYlkBfgi0qjR7pFSaJdCfrk2yNchUz1yja7in1tlgfF6iSkdQ47zC75OmwDW8AfTzMeNSwenqd0g5GR_ynwkmbpRVjbc1Z_O731tEwv7PGvYuLrz5_7pbxyluVbfcfSTqWRD1i3Ld5rsRBb8dwOdM7KPEvw2Xd0YnCpqto1mUe0hy6KHp3FugHYOt3LHEAxNUuLZV-Ja6bcS0axidkgjMFFeu1HteDioqfYc0cDSpBYxJx_N5_Pm6EFNUyU3q_khoLa9btc-PffBSO4h2sqGIc-hVdLJ_Id0o8V5O_AD2bR5Y)

## 想定フロー (メンバーシップとしての VC を発行・連携・検証するまで)

```txt
前提
1. 発行体となるIDQのowner用のProfileドキュメントが生成済みであること。
2. blockcertsを利用すること
```

[![](https://mermaid.ink/img/pako:eNqNVctO21AQ_RXLK1BhAd1lgVRBkZBaiZaWbrJxEqe1yKu2IxUhpPia8CighJSCQml5CAKEkvJoKkp5fMxgO1n1Fzp3nIS8Sssi2PeemTlz5lzfCdEfDciiR9Tkt3E54pcHFOm1KoW9EQH_dEUPycLQwDPbPLMKa2B-BPMIzEuhw145LuVSTvZXeeEUjHlgc1byxF6feyWFQrJuJXfLM0tgXIOxB0bBLhrAFjoFMLK0cIgZ8cGNts9nwbihdQZsHowPYOwDy7glXR5SXI9G4mGfrFbe_XpUFaQeQdIEMHPICNiP7oa9Xr5n76yX9i9LiaS7FZNUXfErMSmiCxoFE5FCta8zMGeB7dPDXJsQymkd5ZybDLAzgk3T75SdSt9efwJWBLaDSVpjfTzUF4r6x_yyqmtcFOJ2T4gUU-4oPhoe4lBs1Ezjbys6yLGD1Px4ldwsmAfAvrUnxLm4-q1Q8yYhcVB7VOWsNUSJBTViNDw40kYdvjXyEIw8GAdcVPaTGHyl6ZxXhtMjdPf1PcD_nvZCojms1Aqw905xCliiMUrrxai7XTTKJpcQ7WKsgpEb7ceyTvaitLWA_inlDPuEccuhqRLMzYQjdOvHFI8w2u-CrZmck5528ZWCKH09jjziMlzlHbHM7dW6PZtuQpOmzXldjCt3PQrYNk_IDsHM08NxC5Kqt-KcIru9mC4n1pyN3SYGfEQeGhAKSbxtM2ltniBjymNSA0c04bmm2KDLnJ_JVkWCf8FYhQ3stAFT0_YOdQ9jreffYK3ONdgUyzjbF6X8YgeYM-gsYDdgHtK5MPkrtwP6aNq62v59udHZZDy0UCl_WiaLkOPzXBjun43ap-f28jMY-CWYr8T2NpVvsEpdYvdIO8tIoPDy-RNElhNGSxpfFVifxte0V68r7TWby86itwsv3vE2KqeWTjD5vdVzNXLFtP1lnfdws2wtfq8vgMYZVqNBJSSjN4ChSXbB3Kp-FacGhgbarWesFHOSe5VB_Xe1BsHaoepFt1I4niW8VPAWwe4Eb8QbEbvEsKyGJSWAl9cEj_GK-hs5LHtFDz4GJHXMK3ojk4jjt8fIeMQvenQ1LneJ8VhA0qsXnegJSiGttvo4oOAXtLYo0-tT94qkm3LyD3fzeFI?type=png)](https://mermaid.live/edit#pako:eNqNVctO21AQ_RXLK1BhAd1lgVRBkZBaiZaWbrJxEqe1yKu2IxUhpPia8CighJSCQml5CAKEkvJoKkp5fMxgO1n1Fzp3nIS8Sssi2PeemTlz5lzfCdEfDciiR9Tkt3E54pcHFOm1KoW9EQH_dEUPycLQwDPbPLMKa2B-BPMIzEuhw145LuVSTvZXeeEUjHlgc1byxF6feyWFQrJuJXfLM0tgXIOxB0bBLhrAFjoFMLK0cIgZ8cGNts9nwbihdQZsHowPYOwDy7glXR5SXI9G4mGfrFbe_XpUFaQeQdIEMHPICNiP7oa9Xr5n76yX9i9LiaS7FZNUXfErMSmiCxoFE5FCta8zMGeB7dPDXJsQymkd5ZybDLAzgk3T75SdSt9efwJWBLaDSVpjfTzUF4r6x_yyqmtcFOJ2T4gUU-4oPhoe4lBs1Ezjbys6yLGD1Px4ldwsmAfAvrUnxLm4-q1Q8yYhcVB7VOWsNUSJBTViNDw40kYdvjXyEIw8GAdcVPaTGHyl6ZxXhtMjdPf1PcD_nvZCojms1Aqw905xCliiMUrrxai7XTTKJpcQ7WKsgpEb7ceyTvaitLWA_inlDPuEccuhqRLMzYQjdOvHFI8w2u-CrZmck5528ZWCKH09jjziMlzlHbHM7dW6PZtuQpOmzXldjCt3PQrYNk_IDsHM08NxC5Kqt-KcIru9mC4n1pyN3SYGfEQeGhAKSbxtM2ltniBjymNSA0c04bmm2KDLnJ_JVkWCf8FYhQ3stAFT0_YOdQ9jreffYK3ONdgUyzjbF6X8YgeYM-gsYDdgHtK5MPkrtwP6aNq62v59udHZZDy0UCl_WiaLkOPzXBjun43ap-f28jMY-CWYr8T2NpVvsEpdYvdIO8tIoPDy-RNElhNGSxpfFVifxte0V68r7TWby86itwsv3vE2KqeWTjD5vdVzNXLFtP1lnfdws2wtfq8vgMYZVqNBJSSjN4ChSXbB3Kp-FacGhgbarWesFHOSe5VB_Xe1BsHaoepFt1I4niW8VPAWwe4Eb8QbEbvEsKyGJSWAl9cEj_GK-hs5LHtFDz4GJHXMK3ojk4jjt8fIeMQvenQ1LneJ8VhA0qsXnegJSiGttvo4oOAXtLYo0-tT94qkm3LyD3fzeFI)

## スケジュール案

1 月：送金機能の実装 (IDQ Token でのやりとり) DID と他のデータの連携 (最初は簡易的なもの)  
2 月：DID と他のデータの連携 (最初は簡易的なもの) & IDQ Token 購入機能(最初はモックアップ) & Francton Ventures ハッカソン(1 月 29 日〜2 月 12 日)  
3 月：共通資金プール機能の繋ぎ込み実装 (今は、Metamask からの呼び出ししかできない状態)  
4 月：ETH Tokyo (4 月 14 日〜16 日)で最後の仕上げをしてこれまでの成果を一旦の形にする。

## その他メモ

### BBS 署名 + Signature Scheme とは

BBS+ Signature Scheme はマルチメッセージに特化した署名スキームで、その最大の特徴は ZKP(ゼロ知識証明)によるメッセージの選択的開示が可能になることで、VC の署名形式として注目されている。DID に紐づく情報として全てのデータを開示することなる。

通常の署名形式では、署名はメッセージ全体に対して作成されます。検証者は、メッセージ全体を知らなければ、署名が正しいことを検証できません。

これに対し、メッセージの一部だけを開示し、それが正しく署名されたメッセージの部分集合であることを証明することを、メッセージの選択的開示と呼びます。BBS+の選択的開示アルゴリズムでは、検証者はメッセージ全てを知ることも、署名の値そのものを知ることもありません。その代わりに、検証者は対応するゼロ知識証明(ZKP)を検証することで、開示されたメッセージの正しさを判断することができます。

### BLS 署名(ボン・リン・シャチャム署名)

イーサリアム 2.0 の Beacon Chain から採用された新たな署名方式を指す。イーサリアム 1.0 で使用されている署名方式は楕円曲線 DSA(通称 ECDSA)であり、両署名ともに楕円曲線のある点を利用し、署名が確実に署名者によるものであることを検証することができる。

イーサリアム 2.0 では BLS 署名は ECDSA より署名サイズが小さいのに強いセキュリティを持つという特徴を利用し、Casper FFG のバリデータの署名によるフォークチョイスルールのために採用されている。イーサリアム 2.0 に採用されている BLS 署名では、Zcash が 2017 年に設計した BLS-12-381 楕円曲線を採用している。
